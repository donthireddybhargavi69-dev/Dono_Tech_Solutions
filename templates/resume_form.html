<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Builder</title>
<style>
    :root {
        --primary: #2c3e50;
        --secondary: #34495e;
        --accent: #3498db;
        --danger: #e74c3c;
        --light: #ecf0f1;
        --dark: #2c3e50;
        --border: #ddd;
        --radius: 8px;
    }

    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #f4f6f8;
        padding: 20px;
        color: var(--dark);
        max-width: 1000px;
        margin: auto;
    }

    h1 {
        text-align: center;
        margin-bottom: 30px;
        font-size: 2.5rem;
        color: var(--primary);
    }

    form {
        background: #fff;
        padding: 30px;
        border-radius: var(--radius);
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .section {
        margin-bottom: 40px;
    }

    .section-title {
        font-size: 1.4rem;
        margin-bottom: 20px;
        border-left: 5px solid var(--accent);
        padding-left: 10px;
        color: var(--secondary);
    }

    .form-group {
        margin-bottom: 15px;
    }

    label {
        display: block;
        margin-bottom: 6px;
        font-weight: 600;
    }

    input[type="text"],
    input[type="email"],
    textarea,
    select {
        width: 100%;
        padding: 10px;
        border: 1px solid var(--border);
        border-radius: var(--radius);
        font-size: 1rem;
        background: #fdfdfd;
        transition: border 0.3s;
    }

    input:focus,
    textarea:focus,
    select:focus {
        border-color: var(--accent);
        outline: none;
    }

    textarea {
        resize: vertical;
        min-height: 100px;
    }

    .btn {
        padding: 10px 18px;
        border: none;
        border-radius: var(--radius);
        font-weight: 600;
        cursor: pointer;
        transition: background 0.3s ease;
    }

    .btn:hover {
        opacity: 0.9;
    }

    .btn-danger {
        background: var(--danger);
        color: white;
    }

    .btn-secondary {
        background: var(--secondary);
        color: white;
    }

    .btn-primary {
        background: var(--accent);
        color: white;
    }

    .dynamic-field {
        background: var(--light);
        padding: 20px;
        border-radius: var(--radius);
        margin-bottom: 20px;
        border-left: 4px solid var(--accent);
    }

    .skill-item,
    .achievement-item,
    .leadership-item {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
        gap: 10px;
    }

    .skill-item input,
    .achievement-item input,
    .leadership-item input {
        flex: 1;
    }

    .form-group > select {
        appearance: none;
        background: url('data:image/svg+xml;utf8,<svg fill="%233498db" height="18" viewBox="0 0 24 24" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>') no-repeat right 10px center/12px auto;
    }

    .form-group:last-child {
        margin-bottom: 0;
    }

    .form-group button {
        margin-top: 10px;
    }

    .form-group .btn-danger {
        padding: 8px 12px;
        font-size: 0.9rem;
    }

    .form-group .btn-secondary {
        margin-top: 10px;
    }

    .form-actions {
        text-align: center;
        margin-top: 40px;
    }

    .form-actions button {
        margin: 10px;
    }

    @media (max-width: 600px) {
        .skill-item,
        .achievement-item,
        .leadership-item {
            flex-direction: column;
            align-items: stretch;
        }

        .btn {
            width: 100%;
        }

        .form-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
    }
</style>

</head>
<body>
            <a href="{% url 'student_dashboard' %}" class="btn btn-light mb-3" style="color:var(--primary-color); font-weight: 600; border-radius: var(--border-radius); padding: 0.5rem 1rem; text-decoration: none; display: inline-block;">&larr; Dashboard</a>
    <h1>Resume Builder</h1>
    <form method="post" action="{% url 'gen_resume' %}">
        {% csrf_token %}
        
        <!-- Basic Information -->
        <div class="section">
            <h2 class="section-title">Basic Information</h2>
            <div class="form-group">
                <label for="name">Full Name</label>
                <input type="text" id="name" name="name" value="{{ form_data.name|default:'' }}" required>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" value="{{ form_data.email|default:'' }}" required>
            </div>
            <div class="form-group">
                <label for="phone">Phone</label>
                <input type="text" id="phone" name="phone" value="{{ form_data.phone|default:'' }}" required>
            </div>
            <div class="form-group">
                <label for="linkedin">LinkedIn Profile</label>
                <input type="text" id="linkedin" name="linkedin" value="{{ form_data.linkedin|default:'' }}">
            </div>
            <div class="form-group">
                <label for="summary">Professional Summary</label>
                <textarea id="summary" name="summary" required>{{ form_data.summary|default:'' }}</textarea>
            </div>
        </div>

        <!-- Skills -->
        <div class="section">
            <h2 class="section-title">Skills</h2>
            <div class="skills-container">
                {% if form_data.skills %}
                    {% for skill in form_data.skills %}
                        <div class="skill-item">
                            <input type="text" name="skills" value="{{ skill }}" required>
                            <button type="button" class="btn-danger" onclick="removeSkill(this)">Remove</button>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="skill-item">
                        <input type="text" name="skills" required>
                        <button type="button" class="btn-danger" onclick="removeSkill(this)">Remove</button>
                    </div>
                {% endif %}
            </div>
            <button type="button" class="btn-secondary" onclick="addSkill()">Add Skill</button>
        </div>

        <!-- Work Experience -->
        <div class="section">
            <h2 class="section-title">Work Experience</h2>
            <div id="work-experience-container">
                {% if form_data.work_experience %}
                    {% for exp in form_data.work_experience %}
                        <div class="dynamic-field">
                            <div class="form-group">
                                <label>Role</label>
                                <input type="text" name="work_role{{ forloop.counter }}" value="{{ exp.role }}" required>
                            </div>
                            <div class="form-group">
                                <label>Company</label>
                                <input type="text" name="work_company{{ forloop.counter }}" value="{{ exp.company }}" required>
                            </div>
                            <div class="form-group">
                                <label>Period</label>
                                <input type="text" name="work_period{{ forloop.counter }}" value="{{ exp.period }}" required>
                            </div>
                            <div class="form-group">
                                <label>Details</label>
                                <textarea name="work_details{{ forloop.counter }}" required>{{ exp.details }}</textarea>
                            </div>
                            <button type="button" class="btn-danger" onclick="removeField(this)">Remove</button>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="dynamic-field">
                        <div class="form-group">
                            <label>Role</label>
                            <input type="text" name="work_role1" required>
                        </div>
                        <div class="form-group">
                            <label>Company</label>
                            <input type="text" name="work_company1" required>
                        </div>
                        <div class="form-group">
                            <label>Period</label>
                            <input type="text" name="work_period1" required>
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="work_details1" required></textarea>
                        </div>
                        <button type="button" class="btn-danger" onclick="removeField(this)">Remove</button>
                    </div>
                {% endif %}
            </div>
            <button type="button" class="btn-secondary" onclick="addWorkExperience()">Add Work Experience</button>
        </div>

        <!-- Education -->
        <div class="section">
            <h2 class="section-title">Education</h2>
            <div id="education-container">
                {% if form_data.education %}
                    {% for edu in form_data.education %}
                        <div class="dynamic-field">
                            <div class="form-group">
                                <label>Institution Name</label>
                                <input type="text" name="edu_name{{ forloop.counter }}" value="{{ edu.name }}" required>
                            </div>
                            <div class="form-group">
                                <label>Period</label>
                                <input type="text" name="edu_period{{ forloop.counter }}" value="{{ edu.period }}" required>
                            </div>
                            <div class="form-group">
                                <label>Details</label>
                                <textarea name="edu_details{{ forloop.counter }}" required>{{ edu.details }}</textarea>
                            </div>
                            <button type="button" class="btn-danger" onclick="removeField(this)">Remove</button>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="dynamic-field">
                        <div class="form-group">
                            <label>Institution Name</label>
                            <input type="text" name="edu_name1" required>
                        </div>
                        <div class="form-group">
                            <label>Period</label>
                            <input type="text" name="edu_period1" required>
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="edu_details1" required></textarea>
                        </div>
                        <button type="button" class="btn-danger" onclick="removeField(this)">Remove</button>
                    </div>
                {% endif %}
            </div>
            <button type="button" class="btn-secondary" onclick="addEducation()">Add Education</button>
        </div>

        <!-- Projects -->
        <div class="section">
            <h2 class="section-title">Projects</h2>
            <div id="projects-container">
                {% if form_data.projects %}
                    {% for proj in form_data.projects %}
                        <div class="dynamic-field">
                            <div class="form-group">
                                <label>Project Title</label>
                                <input type="text" name="proj_title{{ forloop.counter }}" value="{{ proj.title }}" required>
                            </div>
                            <div class="form-group">
                                <label>Year</label>
                                <input type="text" name="proj_year{{ forloop.counter }}" value="{{ proj.year }}" required>
                            </div>
                            <div class="form-group">
                                <label>Description</label>
                                <textarea name="proj_description{{ forloop.counter }}" required>{{ proj.description }}</textarea>
                            </div>
                            <button type="button" class="btn-danger" onclick="removeField(this)">Remove</button>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="dynamic-field">
                        <div class="form-group">
                            <label>Project Title</label>
                            <input type="text" name="proj_title1" required>
                        </div>
                        <div class="form-group">
                            <label>Year</label>
                            <input type="text" name="proj_year1" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea name="proj_description1" required></textarea>
                        </div>
                        <button type="button" class="btn-danger" onclick="removeField(this)">Remove</button>
                    </div>
                {% endif %}
            </div>
            <button type="button" class="btn-secondary" onclick="addProject()">Add Project</button>
        </div>

        <!-- Leadership & Achievements -->
        <div class="section">
            <h2 class="section-title">Leadership & Achievements</h2>
            
            <h3>Leadership</h3>
            <div class="leadership-container">
                {% if form_data.leadership %}
                    {% for item in form_data.leadership %}
                        <div class="leadership-item">
                            <input type="text" name="leadership" value="{{ item }}" required>
                            <button type="button" class="btn-danger" onclick="removeLeadership(this)">Remove</button>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="leadership-item">
                        <input type="text" name="leadership" required>
                        <button type="button" class="btn-danger" onclick="removeLeadership(this)">Remove</button>
                    </div>
                {% endif %}
            </div>
            <button type="button" class="btn-secondary" onclick="addLeadership()">Add Leadership Role</button>
            
            <h3>Achievements</h3>
            <div class="achievements-container">
                {% if form_data.achievements %}
                    {% for item in form_data.achievements %}
                        <div class="achievement-item">
                            <input type="text" name="achievements" value="{{ item }}" required>
                            <button type="button" class="btn-danger" onclick="removeAchievement(this)">Remove</button>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="achievement-item">
                        <input type="text" name="achievements" required>
                        <button type="button" class="btn-danger" onclick="removeAchievement(this)">Remove</button>
                    </div>
                {% endif %}
            </div>
            <button type="button" class="btn-secondary" onclick="addAchievement()">Add Achievement</button>
        </div>

        <!-- Personal Information -->
        <div class="section">
            <h2 class="section-title">Personal Information</h2>
            <div class="form-group">
                <label for="father_name">Father's Name</label>
                <input type="text" id="father_name" name="father_name" value="{{ form_data.personal.father_name|default:'' }}">
            </div>
            <div class="form-group">
                <label for="dob">Date of Birth</label>
                <input type="text" id="dob" name="dob" value="{{ form_data.personal.dob|default:'' }}">
            </div>
            <div class="form-group">
                <label for="gender">Gender</label>
                <select id="gender" name="gender">
                    <option value="">Select</option>
                    <option value="Male" {% if form_data.personal.gender == 'Male' %}selected{% endif %}>Male</option>
                    <option value="Female" {% if form_data.personal.gender == 'Female' %}selected{% endif %}>Female</option>
                    <option value="Other" {% if form_data.personal.gender == 'Other' %}selected{% endif %}>Other</option>
                </select>
            </div>
            <div class="form-group">
                <label for="languages">Languages Known</label>
                <input type="text" id="languages" name="languages" value="{{ form_data.personal.languages|default:'' }}">
            </div>
            <div class="form-group">
                <label for="marital_status">Marital Status</label>
                <select id="marital_status" name="marital_status">
                    <option value="">Select</option>
                    <option value="Single" {% if form_data.personal.marital_status == 'Single' %}selected{% endif %}>Single</option>
                    <option value="Married" {% if form_data.personal.marital_status == 'Married' %}selected{% endif %}>Married</option>
                </select>
            </div>
            <div class="form-group">
                <label for="address">Address</label>
                <textarea id="address" name="address">{{ form_data.personal.address|default:'' }}</textarea>
            </div>
        </div>

        <div class="form-group">
            <button type="submit" name="preview" class="btn">Preview Resume</button>
            <button type="submit" name="download" class="btn">Download PDF</button>
        </div>
    </form>

    <script>
    // Initialize counters safely
    let workExpCounter = {% if form_data.work_experience %}{{ form_data.work_experience|length }}{% else %}1{% endif %};
    let eduCounter = {% if form_data.education %}{{ form_data.education|length }}{% else %}1{% endif %};
    let projCounter = {% if form_data.projects %}{{ form_data.projects|length }}{% else %}1{% endif %};

    // Skill functions
    function addSkill() {
        const container = document.querySelector('.skills-container');
        const div = document.createElement('div');
        div.className = 'skill-item';
        div.innerHTML = `
            <input type="text" name="skills" required>
            <button type="button" class="btn-danger" onclick="removeSkill(this)">Remove</button>
        `;
        container.appendChild(div);
    }

    function removeSkill(button) {
        const skillItems = document.querySelectorAll('.skill-item');
        if (skillItems.length > 1) {
            button.parentElement.remove();
        } else {
            button.previousElementSibling.value = '';
        }
    }

    // Work Experience functions
    function addWorkExperience() {
        workExpCounter++;
        const container = document.getElementById('work-experience-container');
        const div = document.createElement('div');
        div.className = 'dynamic-field';
        div.innerHTML = `
            <div class="form-group">
                <label>Role</label>
                <input type="text" name="work_role${workExpCounter}" required>
            </div>
            <div class="form-group">
                <label>Company</label>
                <input type="text" name="work_company${workExpCounter}" required>
            </div>
            <div class="form-group">
                <label>Period</label>
                <input type="text" name="work_period${workExpCounter}" required>
            </div>
            <div class="form-group">
                <label>Details</label>
                <textarea name="work_details${workExpCounter}" required></textarea>
            </div>
            <button type="button" class="btn-danger" onclick="removeField(this)">Remove</button>
        `;
        container.appendChild(div);
    }

    // Education functions
    function addEducation() {
        eduCounter++;
        const container = document.getElementById('education-container');
        const div = document.createElement('div');
        div.className = 'dynamic-field';
        div.innerHTML = `
            <div class="form-group">
                <label>Institution Name</label>
                <input type="text" name="edu_name${eduCounter}" required>
            </div>
            <div class="form-group">
                <label>Period</label>
                <input type="text" name="edu_period${eduCounter}" required>
            </div>
            <div class="form-group">
                <label>Details</label>
                <textarea name="edu_details${eduCounter}" required></textarea>
            </div>
            <button type="button" class="btn-danger" onclick="removeField(this)">Remove</button>
        `;
        container.appendChild(div);
    }

    // Project functions
    function addProject() {
        projCounter++;
        const container = document.getElementById('projects-container');
        const div = document.createElement('div');
        div.className = 'dynamic-field';
        div.innerHTML = `
            <div class="form-group">
                <label>Project Title</label>
                <input type="text" name="proj_title${projCounter}" required>
            </div>
            <div class="form-group">
                <label>Year</label>
                <input type="text" name="proj_year${projCounter}" required>
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea name="proj_description${projCounter}" required></textarea>
            </div>
            <button type="button" class="btn-danger" onclick="removeField(this)">Remove</button>
        `;
        container.appendChild(div);
    }

    // Leadership functions
    function addLeadership() {
        const container = document.querySelector('.leadership-container');
        const div = document.createElement('div');
        div.className = 'leadership-item';
        div.innerHTML = `
            <input type="text" name="leadership" required>
            <button type="button" class="btn-danger" onclick="removeLeadership(this)">Remove</button>
        `;
        container.appendChild(div);
    }

    function removeLeadership(button) {
        const leadershipItems = document.querySelectorAll('.leadership-item');
        if (leadershipItems.length > 1) {
            button.parentElement.remove();
        } else {
            button.previousElementSibling.value = '';
        }
    }

    // Achievement functions
    function addAchievement() {
        const container = document.querySelector('.achievements-container');
        const div = document.createElement('div');
        div.className = 'achievement-item';
        div.innerHTML = `
            <input type="text" name="achievements" required>
            <button type="button" class="btn-danger" onclick="removeAchievement(this)">Remove</button>
        `;
        container.appendChild(div);
    }

    function removeAchievement(button) {
        const achievementItems = document.querySelectorAll('.achievement-item');
        if (achievementItems.length > 1) {
            button.parentElement.remove();
        } else {
            button.previousElementSibling.value = '';
        }
    }

    // Generic field removal
    function removeField(button) {
        button.parentElement.remove();
    }
</script>
</body>
</html>